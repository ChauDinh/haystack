CREATE KEYSPACE photo with replication = {'class':'SimpleStrategy','replication_factor':1};

USE photo;

// status: 0 - only readable, 1 - writable
CREATE TABLE store (
  lvid int primary key,
  mid set<varchar>,
  status int
);

INSERT INTO store (lvid, mid, status)
VALUES (0, {'172.20.0.6:8080','172.20.0.7:8080'}, 0);

INSERT INTO store (lvid, mid, status)
VALUES (1, {'172.20.0.6:8080','172.20.0.7:8080'}, 1);


CREATE TABLE photo (
  pid int primary key,
  cache_url varchar,
  mid set<varchar>,
  lvid int
);


INSERT INTO photo (pid, cache_url, mid, lvid)
VALUES (1, '172.20.0.5:8080', {'172.20.0.6:8080','172.20.0.7:8080'}, 0);

INSERT INTO photo (pid, cache_url, mid, lvid)
VALUES (2, '172.20.0.5:8080', {'172.20.0.6:8080','172.20.0.7:8080'}, 0);

INSERT INTO photo (pid, cache_url, mid, lvid)
VALUES (3, '172.20.0.5:8080', {'172.20.0.6:8080','172.20.0.7:8080'}, 0);

INSERT INTO photo (pid, cache_url, mid, lvid)
VALUES (4, '172.20.0.5:8080', {'172.20.0.6:8080','172.20.0.7:8080'}, 0);

INSERT INTO photo (pid, cache_url, mid, lvid)
VALUES (5, '172.20.0.5:8080', {'172.20.0.6:8080','172.20.0.7:8080'}, 0);


CREATE TABLE pid_counter ( 
  tag varchar primary key,
  counter_value counter 
);

// maintain the next available pid
UPDATE pid_counter SET counter_value = counter_value + 6 WHERE tag = 'main';